<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<LINK REL="stylesheet" TYPE="text/css" TITLE="Style" href="../../../stylesheet.css">
</head>
<body>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td class="bannercell" rowspan="2"><a href="http://phing.info/"><img src="http://phing.info/images/phing.gif" alt="http://phing.info/" align="left" border="0"></a></td>
<td style="text-align:right"><h2>Source Code Coverage</h2></td>
</tr>
<tr><td style="text-align:right">Designed for use with <a href="http://pear.php.net/package/PHPUnit2">PHPUnit2</a>, <a href="http://www.xdebug.org/">Xdebug</a> and <a href="http://phing.info/">Phing</a>.</td></tr>
</table>
<hr size="1">
<table class="log" cellpadding="5" cellspacing="0" width="100%"><tr class="a">
<td class="small">Methods: 38</td>
<td class="small">LOC: 600</td>
<td class="small">Statements: 170</td>
</tr></table>
<table class="log" cellpadding="5" cellspacing="0" width="100%"><tbody><tr>
<td class="legendItem" width="0%">Legend:</td>
<td class="legendValue" width="100%">
<span class="legendCovered">executed</span><span class="legendUncovered">not executed</span><span class="legendDeadCode">dead code</span>
</td>
</tr></tbody></table>
<table class="log" cellpadding="5" cellspacing="0" width="100%">
<tr>
<th width="100%">Source file</th>
<th>Statements</th>
<th>Methods</th>
<th width="250" colspan="2" nowrap>Total coverage</th>
</tr>
<tr class="a">
<td>Identity.php</td>
<td>5.9%</td>
<td>10.5%</td>
<td>6.7%</td>
<td><table cellspacing="0" cellpadding="0" border="0" width="100%" style="display: inline"><tr>
<td class="covered" width="13" height="12"> </td>
<td class="uncovered" width="187" height="12"> </td>
</tr></table></td>
</tr>
</table>
<table cellspacing="0" cellpadding="0" width="100%">
<tr>
<td class="lineCount">1</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">&lt;?php</pre></td>
</tr>
<tr>
<td class="lineCount">2</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">/**</pre></td>
</tr>
<tr>
<td class="lineCount">3</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * AgilePHP Framework :: The Rapid "for developers" PHP5 framework</pre></td>
</tr>
<tr>
<td class="lineCount">4</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * Copyright (C) 2009-2010 Make A Byte, inc</pre></td>
</tr>
<tr>
<td class="lineCount">5</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> *</pre></td>
</tr>
<tr>
<td class="lineCount">6</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * This program is free software: you can redistribute it and/or modify</pre></td>
</tr>
<tr>
<td class="lineCount">7</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * it under the terms of the GNU General Public License as published by</pre></td>
</tr>
<tr>
<td class="lineCount">8</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * the Free Software Foundation, either version 3 of the License, or</pre></td>
</tr>
<tr>
<td class="lineCount">9</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * (at your option) any later version.</pre></td>
</tr>
<tr>
<td class="lineCount">10</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> *</pre></td>
</tr>
<tr>
<td class="lineCount">11</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * This program is distributed in the hope that it will be useful,</pre></td>
</tr>
<tr>
<td class="lineCount">12</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</pre></td>
</tr>
<tr>
<td class="lineCount">13</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</pre></td>
</tr>
<tr>
<td class="lineCount">14</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * GNU General Public License for more details.</pre></td>
</tr>
<tr>
<td class="lineCount">15</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> *</pre></td>
</tr>
<tr>
<td class="lineCount">16</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * You should have received a copy of the GNU General Public License</pre></td>
</tr>
<tr>
<td class="lineCount">17</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</pre></td>
</tr>
<tr>
<td class="lineCount">18</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> *</pre></td>
</tr>
<tr>
<td class="lineCount">19</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * @package com.makeabyte.agilephp</pre></td>
</tr>
<tr>
<td class="lineCount">20</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> */</pre></td>
</tr>
<tr>
<td class="lineCount">21</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">22</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">/**</pre></td>
</tr>
<tr>
<td class="lineCount">23</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * NOTE: PDO objects can *NOT* be serialized. Since this component</pre></td>
</tr>
<tr>
<td class="lineCount">24</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * 		 is stored in the HTTP session (serialized), this class</pre></td>
</tr>
<tr>
<td class="lineCount">25</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * 		 can not extend any of the base MVC controllers that store</pre></td>
</tr>
<tr>
<td class="lineCount">26</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * 		 an instance of PDO, nor can it store the ORM</pre></td>
</tr>
<tr>
<td class="lineCount">27</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * 		 itself!</pre></td>
</tr>
<tr>
<td class="lineCount">28</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> *</pre></td>
</tr>
<tr>
<td class="lineCount">29</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * Includes all identity package dependancies</pre></td>
</tr>
<tr>
<td class="lineCount">30</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> */</pre></td>
</tr>
<tr>
<td class="lineCount">31</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">require_once 'identity/IdentityManager.php';</pre></td>
</tr>
<tr>
<td class="lineCount">32</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">require_once 'identity/IdentityModel.php';</pre></td>
</tr>
<tr>
<td class="lineCount">33</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">34</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">/**</pre></td>
</tr>
<tr>
<td class="lineCount">35</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * Provides a means for tracking a users identity throughout the</pre></td>
</tr>
<tr>
<td class="lineCount">36</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * web application. The Identity component automatically handles</pre></td>
</tr>
<tr>
<td class="lineCount">37</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * creating sessions, ORM, and sending emails to deal with</pre></td>
</tr>
<tr>
<td class="lineCount">38</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * password resets.</pre></td>
</tr>
<tr>
<td class="lineCount">39</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> *</pre></td>
</tr>
<tr>
<td class="lineCount">40</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * @author Jeremy Hahn</pre></td>
</tr>
<tr>
<td class="lineCount">41</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * @copyright Make A Byte, inc</pre></td>
</tr>
<tr>
<td class="lineCount">42</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> * @package com.makeabyte.agilephp</pre></td>
</tr>
<tr>
<td class="lineCount">43</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"> */</pre></td>
</tr>
<tr>
<td class="lineCount">44</td>
<td class="coverageCount"></td>
<td class="srcLineClassStart"><pre class="srcLine">class Identity implements IdentityManager {</pre></td>
</tr>
<tr>
<td class="lineCount">45</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">46</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">  	  private static $instance;</pre></td>
</tr>
<tr>
<td class="lineCount">47</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">48</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  private $model;</pre></td>
</tr>
<tr>
<td class="lineCount">49</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  private $modelName;</pre></td>
</tr>
<tr>
<td class="lineCount">50</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">51</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  private $resetPasswordUrl;</pre></td>
</tr>
<tr>
<td class="lineCount">52</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  private $confirmationUrl;</pre></td>
</tr>
<tr>
<td class="lineCount">53</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">54</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  private $session;</pre></td>
</tr>
<tr>
<td class="lineCount">55</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">56</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  private function __construct() {</pre></td>
</tr>
<tr>
<td class="lineCount">57</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">58</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		  $agilephp_xml = AgilePHP::getFramework()-&gt;getWebRoot() . DIRECTORY_SEPARATOR . 'agilephp.xml';</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">59</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		  $xml = simplexml_load_file( $agilephp_xml );</pre></td>
</tr>
<tr>
<td class="lineCount">60</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">61</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		  if( !$xml-&gt;identity )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">62</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		  	  throw new FrameworkException( 'Identity component requires a valid component configuration entry in agilephp.xml' );</pre></td>
</tr>
<tr>
<td class="lineCount">63</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">64</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  	      if( $model = (string)$xml-&gt;identity-&gt;attributes()-&gt;model ) {</pre></td>
</tr>
<tr>
<td class="lineCount">65</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">66</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  	      	  $this-&gt;model = new $model();</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">67</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">		  		  $this-&gt;modelName = $model;</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">68</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">		  		  Log::debug( 'Identity::__construct Initalizing domain model object \'' . $this-&gt;getModelName() . '\'.' );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">69</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  	      }</pre></td>
</tr>
<tr>
<td class="lineCount">70</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  	      else {</pre></td>
</tr>
<tr>
<td class="lineCount">71</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">72</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  	      	  $this-&gt;model = new User();</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">73</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  	      	  $this-&gt;modelName = 'User';</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">74</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  	      	  Log::debug( 'Identity::__construct Initalizing with framework \'User\' domain model object.' );</pre></td>
</tr>
<tr>
<td class="lineCount">75</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  	      }</pre></td>
</tr>
<tr>
<td class="lineCount">76</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">77</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		  $passwordResetUrl = (string)$xml-&gt;identity-&gt;attributes()-&gt;resetPasswordUrl;</pre></td>
</tr>
<tr>
<td class="lineCount">78</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  		  if( $passwordResetUrl )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">79</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		      $this-&gt;resetPasswordUrl = $passwordResetUrl;</pre></td>
</tr>
<tr>
<td class="lineCount">80</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">81</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		  $confirmUrl = (string)$xml-&gt;identity-&gt;attributes()-&gt;confirmationUrl;</pre></td>
</tr>
<tr>
<td class="lineCount">82</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  		  if( $confirmUrl )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">83</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		      $this-&gt;confirmationUrl = $confirmUrl;</pre></td>
</tr>
<tr>
<td class="lineCount">84</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">85</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		  $this-&gt;session = Scope::getSessionScope();</pre></td>
</tr>
<tr>
<td class="lineCount">86</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">87</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  		  // Initalize Identity from previous session if one exits</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">88</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">      		  if( $username = $this-&gt;session-&gt;get( 'IDENTITY_USERNAME' ) ) {</pre></td>
</tr>
<tr>
<td class="lineCount">89</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">90</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		  	  $this-&gt;model-&gt;setUsername( $username );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">91</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	 		  	  if( $this-&gt;model-&gt;getRoles() ) {</pre></td>
</tr>
<tr>
<td class="lineCount">92</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">93</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	      		  	  foreach( $this-&gt;model-&gt;getRoles() as $Role ) {</pre></td>
</tr>
<tr>
<td class="lineCount">94</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">95</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">		  		 		  if( $this-&gt;getModel()-&gt;getRoleId() == $Role-&gt;getName() ) {</pre></td>
</tr>
<tr>
<td class="lineCount">96</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">97</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">		  		 		  	  $this-&gt;setRole( $Role );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">98</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">		  		 		  	  break;</pre></td>
</tr>
<tr>
<td class="lineCountDeadCode">99</td>
<td class="coverageCountDeadCode"></td>
<td class="srcLineDeadCode"><pre class="srcLineDeadCode">		  		 		  }</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">100</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">		  		 	 }</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">101</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	 		  	  }</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">102</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	 		  	  $this-&gt;getModel()-&gt;setSession( $this-&gt;session-&gt;getSession() );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">103</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">      		  }</pre></td>
</tr>
<tr>
<td class="lineCount">104</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">105</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">106</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">107</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * Returns a singleton instance of the 'Identity' component.</pre></td>
</tr>
<tr>
<td class="lineCount">108</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   *</pre></td>
</tr>
<tr>
<td class="lineCount">109</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @return void</pre></td>
</tr>
<tr>
<td class="lineCount">110</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">111</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public static function getInstance() {</pre></td>
</tr>
<tr>
<td class="lineCount">112</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountCovered">113</td>
<td class="lineCountCovered">3</td>
<td class="srcLineCovered"><pre class="srcLineCovered">			 if( self::$instance == null )</pre></td>
</tr>
<tr>
<td class="lineCountCovered">114</td>
<td class="lineCountCovered">3</td>
<td class="srcLineCovered"><pre class="srcLineCovered">		 	 	 self::$instance = new self;</pre></td>
</tr>
<tr>
<td class="lineCount">115</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountCovered">116</td>
<td class="lineCountCovered">3</td>
<td class="srcLineCovered"><pre class="srcLineCovered">	  	     return self::$instance;</pre></td>
</tr>
<tr>
<td class="lineCount">117</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">118</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">119</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">120</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">121</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#setModel($model)</pre></td>
</tr>
<tr>
<td class="lineCount">122</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">123</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function setModel( $model ) {</pre></td>
</tr>
<tr>
<td class="lineCount">124</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">125</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;model = $model;</pre></td>
</tr>
<tr>
<td class="lineCount">126</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">127</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">128</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">129</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">130</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#getModel()</pre></td>
</tr>
<tr>
<td class="lineCount">131</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">132</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function getModel() {</pre></td>
</tr>
<tr>
<td class="lineCount">133</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountCovered">134</td>
<td class="lineCountCovered">1</td>
<td class="srcLineCovered"><pre class="srcLineCovered">	  		 return $this-&gt;model;</pre></td>
</tr>
<tr>
<td class="lineCount">135</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">136</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">137</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">138</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">139</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#setUsername($username)</pre></td>
</tr>
<tr>
<td class="lineCount">140</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">141</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function setUsername( $username ) {</pre></td>
</tr>
<tr>
<td class="lineCount">142</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">143</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;getModel()-&gt;setUsername( $username );</pre></td>
</tr>
<tr>
<td class="lineCount">144</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">145</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">146</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">147</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">148</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see  src/identity/IdentityManager#setPassword($password)</pre></td>
</tr>
<tr>
<td class="lineCount">149</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">150</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function setPassword( $password ) {</pre></td>
</tr>
<tr>
<td class="lineCount">151</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">152</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;getModel()-&gt;setPassword( $password );</pre></td>
</tr>
<tr>
<td class="lineCount">153</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">154</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">155</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">156</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">157</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#getUsername()</pre></td>
</tr>
<tr>
<td class="lineCount">158</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">159</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function getUsername() {</pre></td>
</tr>
<tr>
<td class="lineCount">160</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">161</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 return $this-&gt;getModel()-&gt;getUsername();</pre></td>
</tr>
<tr>
<td class="lineCount">162</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">163</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">164</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">165</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">166</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#getPassword()</pre></td>
</tr>
<tr>
<td class="lineCount">167</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">168</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function getPassword() {</pre></td>
</tr>
<tr>
<td class="lineCount">169</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">170</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 return $this-&gt;getModel()-&gt;getPassword();</pre></td>
</tr>
<tr>
<td class="lineCount">171</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">172</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">173</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">174</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">175</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#setEmail($email)</pre></td>
</tr>
<tr>
<td class="lineCount">176</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">177</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function setEmail( $email ) {</pre></td>
</tr>
<tr>
<td class="lineCount">178</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">179</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;getModel()-&gt;setEmail( $email );</pre></td>
</tr>
<tr>
<td class="lineCount">180</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">181</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">182</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">183</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">184</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#getEmail()</pre></td>
</tr>
<tr>
<td class="lineCount">185</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">186</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function getEmail() {</pre></td>
</tr>
<tr>
<td class="lineCount">187</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">188</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 return $this-&gt;getModel()-&gt;getEmail();</pre></td>
</tr>
<tr>
<td class="lineCount">189</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">190</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">191</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">192</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">193</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#setCreated($dateTime)</pre></td>
</tr>
<tr>
<td class="lineCount">194</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">195</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function setCreated( $dateTime ) {</pre></td>
</tr>
<tr>
<td class="lineCount">196</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">197</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;getModel()-&gt;setCreated( $dateTime );</pre></td>
</tr>
<tr>
<td class="lineCount">198</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">199</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">200</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">201</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">202</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#getCreated()</pre></td>
</tr>
<tr>
<td class="lineCount">203</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">204</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function getCreated() {</pre></td>
</tr>
<tr>
<td class="lineCount">205</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">206</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 return $this-&gt;getModel()-&gt;getCreated();</pre></td>
</tr>
<tr>
<td class="lineCount">207</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">208</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">209</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">210</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">211</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#setLastLogin($dateTime)</pre></td>
</tr>
<tr>
<td class="lineCount">212</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">213</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function setLastLogin( $dateTime ) {</pre></td>
</tr>
<tr>
<td class="lineCount">214</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">215</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;getModel()-&gt;setLastLogin( $dateTime );</pre></td>
</tr>
<tr>
<td class="lineCount">216</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">217</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">218</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">219</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">220</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#getLastLogin()</pre></td>
</tr>
<tr>
<td class="lineCount">221</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">222</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function getLastLogin() {</pre></td>
</tr>
<tr>
<td class="lineCount">223</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">224</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 return $this-&gt;getModel()-&gt;getLastLogin();</pre></td>
</tr>
<tr>
<td class="lineCount">225</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">226</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">227</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">228</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">229</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#setEnabled($value)</pre></td>
</tr>
<tr>
<td class="lineCount">230</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">231</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function setEnabled( $value ) {</pre></td>
</tr>
<tr>
<td class="lineCount">232</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">233</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;getModel()-&gt;setEnabled( $value );</pre></td>
</tr>
<tr>
<td class="lineCount">234</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">235</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">236</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">237</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">238</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#getEnabled()</pre></td>
</tr>
<tr>
<td class="lineCount">239</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">240</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function getEnabled() {</pre></td>
</tr>
<tr>
<td class="lineCount">241</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">242</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 return $this-&gt;getModel()-&gt;getEnabled();</pre></td>
</tr>
<tr>
<td class="lineCount">243</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">244</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">245</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">246</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">247</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#setRole($role)</pre></td>
</tr>
<tr>
<td class="lineCount">248</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">249</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function setRole( Role $role ) {</pre></td>
</tr>
<tr>
<td class="lineCount">250</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">251</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;getModel()-&gt;setRole( $role );</pre></td>
</tr>
<tr>
<td class="lineCount">252</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">253</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">254</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">255</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">256</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#getRole()</pre></td>
</tr>
<tr>
<td class="lineCount">257</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">258</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function getRole() {</pre></td>
</tr>
<tr>
<td class="lineCount">259</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">260</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 return $this-&gt;getModel()-&gt;getRole();</pre></td>
</tr>
<tr>
<td class="lineCount">261</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">262</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">263</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">264</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">265</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#hasRole($role)</pre></td>
</tr>
<tr>
<td class="lineCount">266</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">267</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function hasRole( $role ) {</pre></td>
</tr>
<tr>
<td class="lineCount">268</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountCovered">269</td>
<td class="lineCountCovered">1</td>
<td class="srcLineCovered"><pre class="srcLineCovered">	  		 if( isset( $this-&gt;model ) &amp;&amp; $this-&gt;model-&gt;getRole() )</pre></td>
</tr>
<tr>
<td class="lineCountCovered">270</td>
<td class="lineCountCovered">1</td>
<td class="srcLineCovered"><pre class="srcLineCovered">	  		 	 return $this-&gt;getModel()-&gt;getRole()-&gt;getName() == $role;</pre></td>
</tr>
<tr>
<td class="lineCount">271</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountCovered">272</td>
<td class="lineCountCovered">1</td>
<td class="srcLineCovered"><pre class="srcLineCovered">	  		 return false;</pre></td>
</tr>
<tr>
<td class="lineCount">273</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">274</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">275</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">276</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">277</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#revokeRole()</pre></td>
</tr>
<tr>
<td class="lineCount">278</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">279</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function revokeRole() {</pre></td>
</tr>
<tr>
<td class="lineCount">280</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">281</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;setRole( null );</pre></td>
</tr>
<tr>
<td class="lineCount">282</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">283</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">284</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">285</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">286</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#setPasswordResetUrl($url)</pre></td>
</tr>
<tr>
<td class="lineCount">287</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">288</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function setPasswordResetUrl( $url ) {</pre></td>
</tr>
<tr>
<td class="lineCount">289</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">290</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;resetPasswordUrl = $url;</pre></td>
</tr>
<tr>
<td class="lineCount">291</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">292</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">293</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">294</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">295</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#getPasswordResetUrl()</pre></td>
</tr>
<tr>
<td class="lineCount">296</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">297</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function getPasswordResetUrl()  {</pre></td>
</tr>
<tr>
<td class="lineCount">298</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">299</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 return $this-&gt;resetPasswordUrl;</pre></td>
</tr>
<tr>
<td class="lineCount">300</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">301</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">302</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">303</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">304</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#getConfirmationUrl()</pre></td>
</tr>
<tr>
<td class="lineCount">305</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">306</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function getConfirmationUrl() {</pre></td>
</tr>
<tr>
<td class="lineCount">307</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">308</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 return $this-&gt;confirmationUrl;</pre></td>
</tr>
<tr>
<td class="lineCount">309</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">310</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">311</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">312</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">313</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#forgotPassword($subject=null,$body=null)</pre></td>
</tr>
<tr>
<td class="lineCount">314</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">315</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function forgotPassword( $subject = null, $body = null ) {</pre></td>
</tr>
<tr>
<td class="lineCount">316</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">317</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !$this-&gt;getPasswordResetUrl() )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">318</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 throw new FrameworkException( 'Identity::forgotPassword requires a valid passwordResetUrl property value.' );</pre></td>
</tr>
<tr>
<td class="lineCount">319</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">320</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">  		 	 if( !$this-&gt;getModel()-&gt;getUsername() )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">321</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 throw new FrameworkException( 'Identity::forgotPassword requires a valid username property value for model \'' . $this-&gt;getModelName() . '\'.' );</pre></td>
</tr>
<tr>
<td class="lineCount">322</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">323</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !$this-&gt;getModel()-&gt;getEmail() )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">324</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 throw new FrameworkException( 'Identity::forgotPassword requires a valid email property value for model \'' . $this-&gt;getModelName() . '\'.' );</pre></td>
</tr>
<tr>
<td class="lineCount">325</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">326</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $token = $this-&gt;createToken();</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">327</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;session-&gt;set( 'resetPasswordToken', $token );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">328</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;session-&gt;set( 'username', $this-&gt;getUsername() );</pre></td>
</tr>
<tr>
<td class="lineCount">329</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">330</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  		 // Make sure email exists!</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">331</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $table = ORM::getTableByModelName( $this-&gt;getModelName() );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">332</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $emailColumn = $table-&gt;getColumnNameByProperty( 'email' );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">333</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 ORM::prepare( 'SELECT ' . $emailColumn . ' FROM ' . $table-&gt;getName() . ' WHERE ' . $emailColumn . '=? AND username=?;' );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">334</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $params = array( $this-&gt;getEmail(),</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">335</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 				  $this-&gt;getUsername() );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">336</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !ORM::execute( $params )-&gt;fetch() )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">337</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 throw new FrameworkException( 'The information provided does not match our records.' );</pre></td>
</tr>
<tr>
<td class="lineCount">338</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">339</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  		 // Send email</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">340</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !$subject ) $subject = AgilePHP::getFramework()-&gt;getAppName() . ' :: Forgotten Password';</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">341</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !$body ) $body = 'Click on the following link to reset your password: ' . $this-&gt;getPasswordResetUrl() . '/' . $token . '/' . $this-&gt;session-&gt;getSessionId();</pre></td>
</tr>
<tr>
<td class="lineCount">342</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">343</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !mail( $this-&gt;getModel()-&gt;getEmail(), $subject, $body, $this-&gt;getMailHeaders() ) )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">344</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 throw new FrameworkException( 'Error sending forgot password email.' );</pre></td>
</tr>
<tr>
<td class="lineCount">345</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">346</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">347</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">348</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">349</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#resetPassword($token,$sessionId,$subject=null,$body=null)</pre></td>
</tr>
<tr>
<td class="lineCount">350</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">351</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function resetPassword( $token, $sessionId, $subject = null, $body = null ) {</pre></td>
</tr>
<tr>
<td class="lineCount">352</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">353</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;session-&gt;setSessionId( $sessionId );</pre></td>
</tr>
<tr>
<td class="lineCount">354</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">355</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( $token !== $this-&gt;session-&gt;get( 'resetPasswordToken' ) )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">356</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 throw new FrameworkException( 'Invalid token: ' . $token );</pre></td>
</tr>
<tr>
<td class="lineCount">357</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">358</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $newPassword = $this-&gt;createToken();</pre></td>
</tr>
<tr>
<td class="lineCount">359</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">360</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !$subject ) $subject = AgilePHP::getFramework()-&gt;getAppName() . ' :: New Password';</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">361</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !$body ) $body = 'Your new password is: ' . $newPassword;</pre></td>
</tr>
<tr>
<td class="lineCount">362</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">363</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;setUsername( $this-&gt;session-&gt;get( 'username' ) );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">364</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;setPassword( $newPassword );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">365</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;merge();</pre></td>
</tr>
<tr>
<td class="lineCount">366</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">367</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !mail( $this-&gt;getEmail(), $subject, $body, $this-&gt;getMailHeaders() ) )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">368</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 throw new FrameworkException( 'Error sending reset password email.' );</pre></td>
</tr>
<tr>
<td class="lineCount">369</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">370</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;session-&gt;destroy();</pre></td>
</tr>
<tr>
<td class="lineCount">371</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">372</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">373</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">374</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">375</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#register()</pre></td>
</tr>
<tr>
<td class="lineCount">376</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">377</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function register( $subject = null, $body = null ) {</pre></td>
</tr>
<tr>
<td class="lineCount">378</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">379</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $token = $this-&gt;createToken();</pre></td>
</tr>
<tr>
<td class="lineCount">380</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">381</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;session-&gt;set( 'activationToken', $token );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">382</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;session-&gt;set( 'username', $this-&gt;getUsername() );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">383</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;session-&gt;persist();</pre></td>
</tr>
<tr>
<td class="lineCount">384</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">385</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;setCreated( strtotime( 'now' ) );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">386</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;setEnabled( 0 );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">387</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;getModel()-&gt;setSession( $this-&gt;session-&gt;getSession() );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">388</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;persist();</pre></td>
</tr>
<tr>
<td class="lineCount">389</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">390</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !$subject )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">391</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 $subject = AgilePHP::getFramework()-&gt;getAppName() . ' :: Registration Confirmation';</pre></td>
</tr>
<tr>
<td class="lineCount">392</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">393</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !$body )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">394</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 $body = 'Click on the following link to confirm your registration: ' . $this-&gt;getConfirmationUrl() . '/' .</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">395</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 				 $token . '/' . $this-&gt;session-&gt;getSessionId();</pre></td>
</tr>
<tr>
<td class="lineCount">396</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">397</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !mail( $this-&gt;getEmail(), $subject, $body, $this-&gt;getMailHeaders() ) )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">398</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 throw new FrameworkException( 'Error sending registration email.' );</pre></td>
</tr>
<tr>
<td class="lineCount">399</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">400</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">401</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">402</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">403</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#confirm($token, $sessionId)</pre></td>
</tr>
<tr>
<td class="lineCount">404</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">405</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function confirm( $token, $sessionId ) {</pre></td>
</tr>
<tr>
<td class="lineCount">406</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">407</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;session-&gt;setSessionId( $sessionId );</pre></td>
</tr>
<tr>
<td class="lineCount">408</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">409</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( $token !== $this-&gt;session-&gt;get( 'activationToken' ) )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">410</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 throw new FrameworkException( 'Invalid token: ' . $token );</pre></td>
</tr>
<tr>
<td class="lineCount">411</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">412</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $user = new User();</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">413</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $user-&gt;setUsername( $this-&gt;session-&gt;get( 'username' ) ); // #@Id interceptor performs lookup</pre></td>
</tr>
<tr>
<td class="lineCount">414</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">415</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !$user-&gt;getPassword() )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">416</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 throw new FrameworkException( 'User not found' );</pre></td>
</tr>
<tr>
<td class="lineCount">417</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">418</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;setModel( $user );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">419</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;setEnabled( 1 );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">420</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;merge();</pre></td>
</tr>
<tr>
<td class="lineCount">421</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">422</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;session-&gt;destroy();</pre></td>
</tr>
<tr>
<td class="lineCount">423</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">424</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">425</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">426</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">427</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#login($username, $password)</pre></td>
</tr>
<tr>
<td class="lineCount">428</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @throws AccessDeniedException</pre></td>
</tr>
<tr>
<td class="lineCount">429</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">430</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function login( $username, $password ) {</pre></td>
</tr>
<tr>
<td class="lineCount">431</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">432</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !$this-&gt;getModel() ) throw new FrameworkException( 'Identity::login Valid user domain model required' );</pre></td>
</tr>
<tr>
<td class="lineCount">433</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">434</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  	     Log::debug( 'Identity::login Authenticating username \'' . $username . '\' with password \'' . $password . '\'.' );</pre></td>
</tr>
<tr>
<td class="lineCount">435</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">436</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;getModel()-&gt;setUsername( $username );</pre></td>
</tr>
<tr>
<td class="lineCount">437</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">438</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !$this-&gt;getModel() ) return false;</pre></td>
</tr>
<tr>
<td class="lineCount">439</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">440</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $crypto = new Crypto();</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">441</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $hashed = $crypto-&gt;getDigest( $password );</pre></td>
</tr>
<tr>
<td class="lineCount">442</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">443</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">			 if( !preg_match( '/' . $hashed . '/', $this-&gt;getPassword() ) )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">444</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">				 return false;</pre></td>
</tr>
<tr>
<td class="lineCount">445</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">446</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( $this-&gt;getModel()-&gt;getRoles() ) {</pre></td>
</tr>
<tr>
<td class="lineCount">447</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">448</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 foreach( $this-&gt;getModel()-&gt;getRoles() as $Role ) {</pre></td>
</tr>
<tr>
<td class="lineCount">449</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">450</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">		  		 		  if( $this-&gt;getModel()-&gt;getRoleId() == $Role-&gt;getName() ) {</pre></td>
</tr>
<tr>
<td class="lineCount">451</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">452</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">		  		 		  	  $this-&gt;setRole( $Role );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">453</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">		  		 		  	  break;</pre></td>
</tr>
<tr>
<td class="lineCountDeadCode">454</td>
<td class="coverageCountDeadCode"></td>
<td class="srcLineDeadCode"><pre class="srcLineDeadCode">		  		 		  }</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">455</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">		  		 }</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">456</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 }</pre></td>
</tr>
<tr>
<td class="lineCount">457</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">458</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !$this-&gt;getModel()-&gt;getEnabled() )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">459</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 throw new AccessDeniedException( 'Your account has been disabled.' );</pre></td>
</tr>
<tr>
<td class="lineCount">460</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">461</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  		 // The session needs to be persisted first to avoid primary key constraint violation</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">462</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">  	  		 $this-&gt;session-&gt;set( 'IDENTITY_LOGGEDIN', true );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">463</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;session-&gt;set( 'IDENTITY_USERNAME', $this-&gt;getUsername() );</pre></td>
</tr>
<tr>
<td class="lineCount">464</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">465</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( !$this-&gt;session-&gt;isPersisted() )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">466</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 $this-&gt;session-&gt;persist();</pre></td>
</tr>
<tr>
<td class="lineCount">467</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">468</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;getModel()-&gt;setLastLogin( strtotime( 'now' ) );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">469</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;getModel()-&gt;setSession( $this-&gt;session-&gt;getSession() );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">470</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $this-&gt;merge();</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">471</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">			 return true;</pre></td>
</tr>
<tr>
<td class="lineCount">472</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">473</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">474</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">475</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">476</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#logout()</pre></td>
</tr>
<tr>
<td class="lineCount">477</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">478</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function logout() {</pre></td>
</tr>
<tr>
<td class="lineCount">479</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">480</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 Log::debug( 'Identity::logout' );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">481</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( isset( $this-&gt;session ) ) $this-&gt;session-&gt;destroy();</pre></td>
</tr>
<tr>
<td class="lineCount">482</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">483</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">484</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">485</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">486</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#isLoggedIn()</pre></td>
</tr>
<tr>
<td class="lineCount">487</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">488</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function isLoggedIn() {</pre></td>
</tr>
<tr>
<td class="lineCount">489</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountCovered">490</td>
<td class="lineCountCovered">1</td>
<td class="srcLineCovered"><pre class="srcLineCovered">	  		 return (isset( $this-&gt;session ) &amp;&amp; $this-&gt;session-&gt;get( 'IDENTITY_LOGGEDIN' ) ) ? true : false;</pre></td>
</tr>
<tr>
<td class="lineCount">491</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">492</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">493</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">494</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">495</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#persist()</pre></td>
</tr>
<tr>
<td class="lineCount">496</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">497</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function persist() {</pre></td>
</tr>
<tr>
<td class="lineCount">498</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">499</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 ORM::persist( $this-&gt;getModel() );</pre></td>
</tr>
<tr>
<td class="lineCount">500</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">501</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">502</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">503</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">504</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#merge()</pre></td>
</tr>
<tr>
<td class="lineCount">505</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">506</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function merge() {</pre></td>
</tr>
<tr>
<td class="lineCount">507</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">508</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 ORM::merge( $this-&gt;getModel() );</pre></td>
</tr>
<tr>
<td class="lineCount">509</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">510</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">511</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">512</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">513</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#delete()</pre></td>
</tr>
<tr>
<td class="lineCount">514</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">515</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function delete() {</pre></td>
</tr>
<tr>
<td class="lineCount">516</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">517</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  	     ORM::delete( $this-&gt;getModel() );</pre></td>
</tr>
<tr>
<td class="lineCount">518</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">519</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">520</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">521</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * (non-PHPdoc)</pre></td>
</tr>
<tr>
<td class="lineCount">522</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @see src/identity/IdentityManager#refresh()</pre></td>
</tr>
<tr>
<td class="lineCount">523</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">524</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function refresh() {</pre></td>
</tr>
<tr>
<td class="lineCount">525</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">526</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 $results = ORM::find( $this-&gt;getModel() );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">527</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 if( isset( $results[0] ) )</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">528</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 	 $this-&gt;setModel( $results[0] );</pre></td>
</tr>
<tr>
<td class="lineCount">529</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">530</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">531</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">532</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * Returns the name of the model the IdentityManager is currently managing.</pre></td>
</tr>
<tr>
<td class="lineCount">533</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   *</pre></td>
</tr>
<tr>
<td class="lineCount">534</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @return String A string representing the name of the domain object model which the</pre></td>
</tr>
<tr>
<td class="lineCount">535</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * 		 		IdentityManager is currently managing.</pre></td>
</tr>
<tr>
<td class="lineCount">536</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">537</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  private function getModelName() {</pre></td>
</tr>
<tr>
<td class="lineCount">538</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">539</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		  return $this-&gt;modelName;</pre></td>
</tr>
<tr>
<td class="lineCount">540</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">541</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">542</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">543</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * Generates a variable length character token used to sign requests.</pre></td>
</tr>
<tr>
<td class="lineCount">544</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   *</pre></td>
</tr>
<tr>
<td class="lineCount">545</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @return String Variable length token that must be present in the reset password</pre></td>
</tr>
<tr>
<td class="lineCount">546</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * 	     		url in order to successfully complete the process.</pre></td>
</tr>
<tr>
<td class="lineCount">547</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">548</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  private function createToken() {</pre></td>
</tr>
<tr>
<td class="lineCount">549</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">550</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">			  $numbers = '1234567890';</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">551</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">			  $lcase = 'abcdefghijklmnopqrstuvwzyz';</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">552</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">			  $ucase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';</pre></td>
</tr>
<tr>
<td class="lineCount">553</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">554</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">			  $length = rand( 1, 20 );</pre></td>
</tr>
<tr>
<td class="lineCount">555</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">556</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">			  $token = null;</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">557</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">			  for( $i=0; $i&lt;$length; $i++ ) {</pre></td>
</tr>
<tr>
<td class="lineCount">558</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">559</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">			  	   if( rand( 0, 1 ) ) {</pre></td>
</tr>
<tr>
<td class="lineCount">560</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">561</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">			  	   	   $cRand = rand( 0, 25 );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">562</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">			  	   	   $token .= (rand( 0, 1) ) ? $lcase[$cRand] : $ucase[$cRand];</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">563</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">			  	   }</pre></td>
</tr>
<tr>
<td class="lineCount">564</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">			  	   else {</pre></td>
</tr>
<tr>
<td class="lineCount">565</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">566</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">			  	   	   $nRand = rand( 0, 9 );</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">567</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">			  	   	   $token .= $numbers[$nRand];</pre></td>
</tr>
<tr>
<td class="lineCount">568</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">			  	   }</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">569</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">			  }</pre></td>
</tr>
<tr>
<td class="lineCount">570</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">571</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		  return $token;</pre></td>
</tr>
<tr>
<td class="lineCount">572</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">573</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">574</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">575</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * Mail headers to use when performing forgot password and reset password operations.</pre></td>
</tr>
<tr>
<td class="lineCount">576</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   *</pre></td>
</tr>
<tr>
<td class="lineCount">577</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @return String Mail headers to use in the sent messsage.</pre></td>
</tr>
<tr>
<td class="lineCount">578</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">579</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  private function getMailHeaders() {</pre></td>
</tr>
<tr>
<td class="lineCount">580</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">581</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		  $headers = 'From: ' . AgilePHP::getFramework()-&gt;getAppName() . ' &lt;no-reply@' . AgilePHP::getFramework()-&gt;getAppName() . '&gt;' . "\n";</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">582</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		  $headers .= 'To: ' . $this-&gt;getModel()-&gt;getUsername() . ' &lt;' . $this-&gt;getModel()-&gt;getEmail() . '&gt;' . "\n";</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">583</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">        	  $headers .= 'Reply-To: ' . $this-&gt;getModel()-&gt;getEmail() . "\n";</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">584</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">          	  $headers .= 'Return-Path: ' . $this-&gt;getModel()-&gt;getEmail() . "\n";</pre></td>
</tr>
<tr>
<td class="lineCountUncovered">585</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">        	  $headers .= 'X-mailer: AgilePHP Framework on PHP (' . phpversion() . ')' . "\n";</pre></td>
</tr>
<tr>
<td class="lineCount">586</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">587</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">        	  return $headers;</pre></td>
</tr>
<tr>
<td class="lineCount">588</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">589</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCount">590</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  /**</pre></td>
</tr>
<tr>
<td class="lineCount">591</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * Destructor prints log debug entry notifying that the identity instance has been destroyed.</pre></td>
</tr>
<tr>
<td class="lineCount">592</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   *</pre></td>
</tr>
<tr>
<td class="lineCount">593</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   * @return void</pre></td>
</tr>
<tr>
<td class="lineCount">594</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	   */</pre></td>
</tr>
<tr>
<td class="lineCount">595</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  public function __destruct() {</pre></td>
</tr>
<tr>
<td class="lineCount">596</td>
<td class="coverageCount"></td>
<td><pre class="srcLine"></pre></td>
</tr>
<tr>
<td class="lineCountUncovered">597</td>
<td class="coverageCountUncovered"></td>
<td class="srcLineUncovered"><pre class="srcLineUncovered">	  		 Log::debug( 'Identity::__destruct Instance destroyed' );</pre></td>
</tr>
<tr>
<td class="lineCount">598</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">	  }</pre></td>
</tr>
<tr>
<td class="lineCount">599</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">}</pre></td>
</tr>
<tr>
<td class="lineCount">600</td>
<td class="coverageCount"></td>
<td><pre class="srcLine">?&gt;</pre></td>
</tr>
</table>
<br><table width="100%">
<tr><td><hr noshade size="1"></td></tr>
<tr><td class="small">Report generated at 2010-06-24T17:36:36-04:00</td></tr>
</table>
</body>
</html>
